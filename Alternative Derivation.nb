(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     34830,        844]
NotebookOptionsPosition[     30578,        753]
NotebookOutlinePosition[     31111,        773]
CellTagsIndexPosition[     31068,        770]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellLabel->
  "In[325]:=",ExpressionUUID->"b629bd2a-9a2b-4c51-862d-3ff989be6f89"],

Cell[CellGroupData[{

Cell["\<\
Bayesian Model of distance perception from ocular convergence\
\>", "Title",
 CellChangeTimes->{{3.857455139906681*^9, 3.8574551618625193`*^9}, {
  3.85745581699737*^9, 
  3.8574558187527227`*^9}},ExpressionUUID->"46c6cc27-553e-4012-9717-\
2846414b1aca"],

Cell["Peter Scarfe and Paul Hibbard (2025)", "Subtitle",
 CellChangeTimes->{{3.85745582356307*^9, 3.85745585116219*^9}, {
   3.857455886359107*^9, 3.857455887113995*^9}, {3.924925851023487*^9, 
   3.92492585132712*^9}, 3.960109134672763*^9, 
   3.960201363464725*^9},ExpressionUUID->"0880dd66-3db0-416f-8f85-\
e37832f61631"],

Cell[CellGroupData[{

Cell["Alterative derivation of the Bayesian Vergence Model", "Chapter",
 CellChangeTimes->{{3.959855987682994*^9, 
  3.959856018835997*^9}},ExpressionUUID->"72e5adbe-0e88-4754-a491-\
614a63a93c40"],

Cell["\<\
Here we do the same math as originally but in plain Mathematica. This allows \
us to see more of the steps compared to using Mathstatica. The format of the \
equation is different to that produced by Mathstatica, but we can easily show \
that the two are mathematically identical. \
\>", "Subtitle",
 CellChangeTimes->{{3.959856823608356*^9, 3.959856861653673*^9}, {
  3.96010885116369*^9, 
  3.9601088881690083`*^9}},ExpressionUUID->"fb494ea7-5bf3-4ae6-8a59-\
7c78d43b68b1"],

Cell[CellGroupData[{

Cell["Define the truncated normal distribution of vergence", "Section",
 CellChangeTimes->{{3.95820361091679*^9, 
  3.958203625964795*^9}},ExpressionUUID->"08877bc0-957c-4be6-9879-\
0691d5e3c32c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Domain", " ", "of", " ", "vergence"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"minVerg", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxVerg", "=", 
     RowBox[{"Pi", "/", "2"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.958286093082367*^9, 3.9582861052309217`*^9}, {
  3.958286139550555*^9, 3.958286149437118*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"44a5c625-b3b3-47e7-8aa4-4d4f3e649e53"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Define", " ", "our", " ", "Gaussian", " ", "for", " ", "vergence"}], " ", 
   "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"normDistrib", "=", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"m", ",", "s"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"vergFullPDF", "=", 
    RowBox[{"PDF", "[", 
     RowBox[{"normDistrib", ",", "x"}], "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{
  3.9598573166223507`*^9, {3.959857352072693*^9, 3.959857382014719*^9}},
 CellLabel->
  "In[328]:=",ExpressionUUID->"a858088c-b2b6-4b66-89c7-d73c92073930"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "m"}], "+", "x"}], ")"}], "2"], 
     RowBox[{"2", " ", 
      SuperscriptBox["s", "2"]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", "s"}]]], "Output",
 CellChangeTimes->{
  3.9598573170585012`*^9, {3.959857377908701*^9, 3.9598573823887463`*^9}, 
   3.959857542826799*^9, 3.9598577052801943`*^9, 3.9598579281993437`*^9, 
   3.9598580146080713`*^9, 3.959858063132655*^9, 3.959858146122274*^9, 
   3.959858190728204*^9, {3.959858239048473*^9, 3.959858267544855*^9}, 
   3.959858321004825*^9, 3.9598584060693407`*^9, 3.959858529710794*^9, 
   3.959858648531871*^9, 3.9598598356727123`*^9, 3.960271919852758*^9},
 CellLabel->
  "Out[329]=",ExpressionUUID->"3884bdd3-8cf2-4ab2-b98c-6b3721fde5be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Truncate", " ", "it", " ", "in", " ", "the", " ", "physical", " ", 
    "bounds", " ", "of", " ", "veregnce"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"truncVergPDF", "[", "x_", "]"}], ":=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"PDF", "[", 
        RowBox[{
         RowBox[{"TruncatedDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0", "minVerg"}], ",", "maxVerg"}], "}"}], ",", 
           "normDistrib"}], "]"}], ",", "x"}], "]"}], ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0", "<", "x", "<", 
           RowBox[{"Pi", "/", "2"}]}], ",", 
          RowBox[{"s", ">", "0"}]}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"truncVergPDF", "[", "x", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.959857328556444*^9, 3.959857335859357*^9}, 
   3.959857387668943*^9, {3.959857531723839*^9, 3.95985756930973*^9}, {
   3.9598582570820513`*^9, 3.959858265122488*^9}, {3.959858387858885*^9, 
   3.959858398548647*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"c044cf71-b31c-4968-8c1c-9594573ea96a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "x"}], ")"}], "2"], 
      RowBox[{"2", " ", 
       SuperscriptBox["s", "2"]}]]}]], " ", 
   SqrtBox[
    FractionBox["2", "\[Pi]"]]}], 
  RowBox[{"s", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Erf", "[", 
      FractionBox["m", 
       RowBox[{
        SqrtBox["2"], " ", "s"}]], "]"}], "-", 
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{"m", "-", 
        FractionBox["\[Pi]", "2"]}], 
       RowBox[{
        SqrtBox["2"], " ", "s"}]], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.959857390723423*^9, {3.959857537036663*^9, 3.959857542846518*^9}, 
   3.959857705371951*^9, 3.959857928283613*^9, 3.9598580146185007`*^9, 
   3.959858063137335*^9, 3.9598581462076473`*^9, 3.959858190733097*^9, {
   3.959858239053301*^9, 3.959858267567301*^9}, 3.959858321009583*^9, 
   3.959858406073565*^9, 3.9598585297214937`*^9, 3.959858648547811*^9, 
   3.9598598356799173`*^9, 3.960271919940795*^9},
 CellLabel->
  "Out[331]=",ExpressionUUID->"34d935d9-d110-4f53-a3ce-4eb4ef0edbac"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Change of variables: step by step", "Section",
 CellChangeTimes->{{3.9582037505974703`*^9, 3.9582037593243237`*^9}, {
  3.958286403661447*^9, 3.958286406857132*^9}, {3.959858422051107*^9, 
  3.959858424558713*^9}},ExpressionUUID->"183a856a-1b25-42f8-b249-\
5a659f85f2f7"],

Cell[CellGroupData[{

Cell["\<\
This the key change of variables step, but done with plain Mathematica.\
\>", "Subsection",
 CellChangeTimes->{{3.9601089127989807`*^9, 
  3.960108930065198*^9}},ExpressionUUID->"6396a341-630f-4596-b0c5-\
2901d16ba3fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Inverse", " ", "of", " ", "the", " ", "function"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"xOfY", "=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{"h", "/", "y"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.958203739931628*^9, 3.958203791128603*^9}, {
   3.958203839773006*^9, 3.958203849856112*^9}, {3.95820391747834*^9, 
   3.958203987724987*^9}, 3.958204559701619*^9, {3.9582046825317173`*^9, 
   3.9582046852108393`*^9}, 3.958210882664632*^9, {3.958286438235973*^9, 
   3.958286450386538*^9}, {3.95985759073031*^9, 3.959857599846912*^9}, 
   3.9598581622849073`*^9},
 CellLabel->
  "In[332]:=",ExpressionUUID->"b164ce35-77bb-4b0c-9c2f-da0d0d11d1d9"],

Cell[BoxData[
 RowBox[{"ArcTan", "[", 
  FractionBox["h", "y"], "]"}]], "Output",
 CellChangeTimes->{
  3.958210905298074*^9, 3.9582110772439537`*^9, 3.958211259880177*^9, {
   3.958211343204441*^9, 3.9582113597982492`*^9}, 3.9582113973372173`*^9, 
   3.9582114482289762`*^9, 3.958211745542054*^9, {3.958211776337791*^9, 
   3.958211789213463*^9}, 3.9582119766183167`*^9, {3.958212062603333*^9, 
   3.95821207403106*^9}, 3.958212133108755*^9, 3.958212192928431*^9, 
   3.95821302879074*^9, {3.95821438131526*^9, 3.958214407625498*^9}, {
   3.958214486600338*^9, 3.9582145785016327`*^9}, 3.958214627695488*^9, 
   3.958214786068804*^9, {3.958214816899448*^9, 3.958214920088131*^9}, 
   3.958215005683217*^9, 3.958216496740767*^9, 3.958282824065461*^9, 
   3.958286130597514*^9, 3.958286321117156*^9, 3.958286517241756*^9, 
   3.958286947351186*^9, 3.958287133274617*^9, {3.958287318595622*^9, 
   3.95828737353325*^9}, 3.958287409179577*^9, 3.958287584932088*^9, 
   3.958287759534836*^9, 3.9582885065508757`*^9, 3.958288674764989*^9, 
   3.958818666567897*^9, 3.9588189983503227`*^9, 3.959672972377564*^9, 
   3.959673027996808*^9, 3.959856100316777*^9, 3.959856346058031*^9, 
   3.9598565267992373`*^9, 3.959856753758507*^9, 3.9598576013413258`*^9, 
   3.959857705375651*^9, 3.95985792828657*^9, 3.9598580146289787`*^9, 
   3.9598580631546164`*^9, 3.9598581462176027`*^9, 3.959858190754059*^9, {
   3.959858239071166*^9, 3.959858267580092*^9}, 3.959858321031499*^9, 
   3.959858406090065*^9, 3.959858529737885*^9, 3.9598586485516367`*^9, 
   3.959859835694151*^9, 3.960271919957814*^9},
 CellLabel->
  "Out[332]=",ExpressionUUID->"61d7b7eb-8952-4a7e-8a7e-1582e18d1c33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Take", " ", "the", " ", "derivative", " ", "with", " ", "respect", " ", 
    "to", " ", "y"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dxdy", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"xOfY", ",", "y"}], "]"}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.958203890887351*^9, {3.958203925971634*^9, 3.958204001244128*^9}, {
   3.958204052606639*^9, 3.958204057506266*^9}, 3.9582045335614367`*^9, 
   3.958204579611184*^9, 3.958204692909502*^9, 3.958204732191826*^9, 
   3.958205158246769*^9, 3.9582054618716717`*^9, 3.958210889060669*^9, {
   3.958286456553389*^9, 3.9582864762337217`*^9}, {3.959857066940452*^9, 
   3.9598570700403833`*^9}, {3.959857606425168*^9, 3.959857623144985*^9}, {
   3.9598581637203817`*^9, 3.959858168961973*^9}},
 CellLabel->
  "In[333]:=",ExpressionUUID->"6969af7a-a7e0-4ee1-9646-5ed7be0fdcf7"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["h", 
   RowBox[{
    SuperscriptBox["h", "2"], "+", 
    SuperscriptBox["y", "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.958205463342413*^9, 3.95820679356894*^9, 3.95820701243291*^9, 
   3.9582071754480457`*^9, 3.958207224305171*^9, 3.958207347966043*^9, 
   3.958207380314376*^9, 3.958207580648299*^9, 3.958207830744246*^9, 
   3.9582089185876293`*^9, 3.958209383264168*^9, 3.958209728056567*^9, 
   3.958209831935554*^9, 3.958210002824835*^9, 3.958210076321886*^9, {
   3.958210110020997*^9, 3.958210156271023*^9}, 3.958210357369645*^9, 
   3.958210427449133*^9, 3.958210562328519*^9, 3.9582106549759827`*^9, 
   3.95821085937672*^9, 3.958210905308301*^9, 3.9582110772491913`*^9, 
   3.958211259890215*^9, {3.9582113432067623`*^9, 3.958211359805654*^9}, 
   3.9582113973392363`*^9, 3.958211448231889*^9, 3.958211745552169*^9, {
   3.958211776341979*^9, 3.958211789216567*^9}, 3.9582119766294327`*^9, {
   3.958212062612176*^9, 3.958212074034822*^9}, 3.958212133119005*^9, 
   3.958212192938068*^9, 3.9582130288001328`*^9, {3.958214381324585*^9, 
   3.958214407634523*^9}, {3.958214486604294*^9, 3.9582145785045567`*^9}, 
   3.958214627707142*^9, 3.958214786079631*^9, {3.958214816903542*^9, 
   3.958214920091234*^9}, 3.958215005687598*^9, 3.958216496753072*^9, 
   3.958282824072866*^9, 3.958286130602565*^9, 3.9582863211272583`*^9, 
   3.9582865172450953`*^9, 3.958286947359243*^9, 3.958287133278905*^9, {
   3.958287318606956*^9, 3.958287373536936*^9}, 3.958287409191669*^9, 
   3.9582875849368467`*^9, 3.958287759538169*^9, 3.958288506555015*^9, 
   3.958288674775023*^9, 3.958818666570732*^9, 3.95881899835321*^9, 
   3.959672972387981*^9, 3.959673028005335*^9, 3.959856100324437*^9, 
   3.959856346068623*^9, 3.959856526808498*^9, 3.9598567537665462`*^9, {
   3.95985760887558*^9, 3.959857627919915*^9}, 3.959857705387586*^9, 
   3.959857928296719*^9, 3.9598580146378927`*^9, 3.9598580631658382`*^9, 
   3.959858146226367*^9, 3.959858190762909*^9, {3.9598582390811663`*^9, 
   3.9598582675906277`*^9}, 3.95985832103434*^9, 3.959858406094956*^9, 
   3.959858529753104*^9, 3.95985864856255*^9, 3.9598598357032747`*^9, 
   3.9602719199675083`*^9},
 CellLabel->
  "Out[333]=",ExpressionUUID->"81c78a6b-fe14-4940-9bb8-6784027ca348"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Absolute", " ", "value", " ", "of", " ", "this"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"absDxDy", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Abs", "[", "dxdy", "]"}], ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"h", ">", "0"}], ",", 
         RowBox[{"y", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.958204698246912*^9, 3.9582047294919863`*^9, 3.9582051630750093`*^9, 
   3.958210130976694*^9, 3.958210896165606*^9, {3.958286486733704*^9, 
   3.958286496091815*^9}, {3.958287613135799*^9, 3.958287652643216*^9}, {
   3.958287745532497*^9, 3.958287755118826*^9}, {3.959857625596897*^9, 
   3.959857625738999*^9}, {3.9598581722793827`*^9, 3.95985817235852*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"01333b3b-be55-4209-8ca2-d81a0c8ee3d0"],

Cell[BoxData[
 FractionBox["h", 
  RowBox[{
   SuperscriptBox["h", "2"], "+", 
   SuperscriptBox["y", "2"]}]]], "Output",
 CellChangeTimes->{{3.9582101317308187`*^9, 3.958210156280367*^9}, 
   3.9582103573726387`*^9, 3.958210427451956*^9, 3.958210562332802*^9, 
   3.958210654978649*^9, 3.958210859384807*^9, 3.958210905310548*^9, 
   3.9582110772517843`*^9, 3.958211259893313*^9, {3.958211343211481*^9, 
   3.9582113598139343`*^9}, 3.9582113973412647`*^9, 3.958211448241498*^9, 
   3.9582117455576077`*^9, {3.958211776350922*^9, 3.9582117892188683`*^9}, 
   3.9582119766340523`*^9, {3.958212062615223*^9, 3.958212074037106*^9}, 
   3.9582121331231537`*^9, 3.9582121929413424`*^9, 3.958213028802938*^9, {
   3.958214381350333*^9, 3.958214407644072*^9}, {3.958214486614236*^9, 
   3.958214578516327*^9}, 3.958214627735104*^9, 3.95821478608316*^9, {
   3.958214816915016*^9, 3.958214920099395*^9}, 3.958215005697098*^9, 
   3.958216496756424*^9, 3.958282824075272*^9, 3.958286130611615*^9, 
   3.958286321132106*^9, 3.9582865172554626`*^9, 3.958286947365232*^9, 
   3.958287133286352*^9, {3.958287318610016*^9, 3.958287373567593*^9}, 
   3.958287409202793*^9, 3.958287584964232*^9, {3.958287638525714*^9, 
   3.9582876530804777`*^9}, {3.9582877562591047`*^9, 3.9582877595473137`*^9}, 
   3.958288506568863*^9, 3.958288674779784*^9, 3.95881866658016*^9, 
   3.95881899836939*^9, 3.959672972391478*^9, 3.9596730280131083`*^9, 
   3.959856100332046*^9, 3.959856346071514*^9, 3.9598565268113327`*^9, 
   3.959856753769484*^9, 3.959857630785968*^9, 3.959857705398732*^9, 
   3.959857928304742*^9, 3.959858014647187*^9, 3.959858063169895*^9, 
   3.9598581462349443`*^9, 3.95985819077304*^9, {3.959858239090659*^9, 
   3.959858267598487*^9}, 3.959858321045245*^9, 3.95985840610291*^9, 
   3.9598585297558823`*^9, 3.9598586485722733`*^9, 3.959859835705472*^9, 
   3.960271919973967*^9},
 CellLabel->
  "Out[334]=",ExpressionUUID->"e8dce85a-7d25-4b7a-84ce-7ea30fdf2c7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Change", " ", "of", " ", "variables"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fY", "[", "y_", "]"}], ":=", 
    RowBox[{
     RowBox[{"truncVergPDF", "[", "xOfY", "]"}], "*", "absDxDy"}]}], "\[IndentingNewLine]", 
   RowBox[{"fY", "[", "y", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.958210634583502*^9, 3.95821063838165*^9}, 
   3.95821090283869*^9, {3.9582110673712254`*^9, 3.958211075136807*^9}, {
   3.9582113585286293`*^9, 3.958211375847084*^9}, {3.958211774558511*^9, 
   3.9582117840089273`*^9}, {3.958286501615123*^9, 3.958286515307828*^9}, {
   3.95828654897152*^9, 3.958286567043563*^9}, 3.958286717503682*^9, {
   3.9598567640431833`*^9, 3.959856765534678*^9}, {3.959857637328144*^9, 
   3.9598576398631973`*^9}, {3.959858129832005*^9, 3.9598581426237926`*^9}, {
   3.9598581819128304`*^9, 3.959858188172783*^9}, {3.9598584037841682`*^9, 
   3.959858404243188*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"687bf7dc-1a75-48f0-a532-4bedd33f47d7"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", 
         RowBox[{"ArcTan", "[", 
          FractionBox["h", "y"], "]"}]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       SuperscriptBox["s", "2"]}]]}]], " ", "h", " ", 
   SqrtBox[
    FractionBox["2", "\[Pi]"]]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["h", "2"], "+", 
     SuperscriptBox["y", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s", " ", 
      RowBox[{"Erf", "[", 
       FractionBox["m", 
        RowBox[{
         SqrtBox["2"], " ", "s"}]], "]"}]}], "-", 
     RowBox[{"s", " ", 
      RowBox[{"Erf", "[", 
       FractionBox[
        RowBox[{"m", "-", 
         FractionBox["\[Pi]", "2"]}], 
        RowBox[{
         SqrtBox["2"], " ", "s"}]], "]"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.9582101075737*^9, 3.9582101562921963`*^9}, 
   3.958210357388431*^9, 3.958210427463799*^9, 3.958210562349061*^9, {
   3.958210639489437*^9, 3.958210655031205*^9}, 3.958210859429432*^9, 
   3.958210905319977*^9, 3.958211077267807*^9, 3.9582112600827227`*^9, {
   3.958211343221218*^9, 3.958211397350604*^9}, 3.958211448252778*^9, 
   3.958211745567361*^9, {3.958211776354516*^9, 3.9582117892279463`*^9}, 
   3.958211976792405*^9, {3.958212062781444*^9, 3.958212074158717*^9}, 
   3.9582121332112637`*^9, 3.9582121931270657`*^9, 3.958213028805752*^9, {
   3.958214381619038*^9, 3.95821440809059*^9}, {3.958214486627755*^9, 
   3.958214578519993*^9}, 3.958214628006752*^9, 3.958214786295027*^9, {
   3.958214816918559*^9, 3.958214891553667*^9}, 3.958215005890231*^9, 
   3.95821649699984*^9, 3.958282824288329*^9, 3.958286130655677*^9, 
   3.958286321142293*^9, 3.958286517258963*^9, {3.958286551316717*^9, 
   3.9582865678194237`*^9}, 3.9582867185590897`*^9, 3.95828694751038*^9, 
   3.958287133289384*^9, {3.958287318621481*^9, 3.958287373690518*^9}, 
   3.958287409206059*^9, 3.95828758506765*^9, 3.958287759673053*^9, 
   3.95828850669986*^9, 3.958288674904174*^9, 3.95881866669473*^9, 
   3.9588189984829407`*^9, 3.959672972513785*^9, 3.959673028017507*^9, 
   3.959856100467492*^9, 3.959856346081439*^9, 3.959856526941608*^9, {
   3.9598567538427687`*^9, 3.959856766214205*^9}, 3.959857163619718*^9, 
   3.9598576410231113`*^9, 3.959857705402629*^9, 3.9598579283074923`*^9, 
   3.9598580146501217`*^9, 3.959858063180995*^9, {3.959858143514749*^9, 
   3.959858146237911*^9}, 3.959858190777555*^9, {3.959858239246417*^9, 
   3.959858267719351*^9}, 3.9598583211159363`*^9, 3.959858406105831*^9, 
   3.959858529768799*^9, 3.95985864864858*^9, 3.959859835714628*^9, 
   3.960271920139604*^9},
 CellLabel->
  "Out[336]=",ExpressionUUID->"a88d6d9a-85a8-4700-b240-be5933a3efe9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Previous way with Mathstatica", "Section",
 CellChangeTimes->{{3.958287259708354*^9, 
  3.9582872665738897`*^9}},ExpressionUUID->"7b5c497d-cf5a-48c6-a7a2-\
527e458c5ca2"],

Cell[CellGroupData[{

Cell["\<\
We repeat what we did originally with Mathstatica and then prove that the two \
are mathematically identical. \
\>", "Subsection",
 CellChangeTimes->{{3.9601089127989807`*^9, 
  3.960108971842598*^9}},ExpressionUUID->"cf43a9f6-0c49-4492-bc9c-\
c6e34737d059"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Define", " ", "our", " ", "Gaussian", " ", "CDF", " ", "vergence", " ", 
    "via", " ", "Mathstatica"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vergFullCDF", "[", "x_", "]"}], " ", "=", " ", 
    RowBox[{"Prob", "[", 
     RowBox[{"x", ",", "vergFullPDF"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.686488827787803*^9, 3.686488905522251*^9}, {
   3.686488966221302*^9, 3.686489046609768*^9}, {3.6864891236254797`*^9, 
   3.6864891399874773`*^9}, {3.686490141888035*^9, 3.686490152511221*^9}, {
   3.686490250757701*^9, 3.686490252469292*^9}, {3.686490285838945*^9, 
   3.686490317821084*^9}, 3.686490411303684*^9, 3.686490955641775*^9, {
   3.686491065149814*^9, 3.686491123634147*^9}, {3.686491172704885*^9, 
   3.686491175119738*^9}, {3.686560975436758*^9, 3.686561032957589*^9}, {
   3.686561916098178*^9, 3.686561961109129*^9}, {3.686562780973298*^9, 
   3.686562795179146*^9}, {3.686636911207598*^9, 3.6866369266505613`*^9}, {
   3.686645963894309*^9, 3.686645976630158*^9}, {3.698316298551611*^9, 
   3.698316299483515*^9}, {3.8223089086719*^9, 3.822308912619727*^9}, {
   3.822309041229521*^9, 3.822309046099148*^9}, {3.822309096985913*^9, 
   3.822309177423949*^9}, {3.822309526248847*^9, 3.822309526483536*^9}, {
   3.822310251709251*^9, 3.822310254583067*^9}, 3.8223103040813518`*^9, {
   3.822310390953855*^9, 3.82231042253283*^9}, 3.822310790407942*^9, {
   3.822310883051622*^9, 3.822310906754355*^9}, 3.822378872384643*^9, {
   3.822378921502771*^9, 3.822378944050585*^9}, {3.822379062798014*^9, 
   3.822379064382311*^9}, {3.822379670738922*^9, 3.822379679633191*^9}, {
   3.822380775862715*^9, 3.822380776154333*^9}, 3.822380893551456*^9, {
   3.834576898755577*^9, 3.834576919970994*^9}, {3.857455700991395*^9, 
   3.857455721270917*^9}, {3.857462751154697*^9, 3.857462753424984*^9}, {
   3.860575936173199*^9, 3.860575953425682*^9}, {3.860576009975659*^9, 
   3.8605760237375526`*^9}, {3.860576651520852*^9, 3.8605766798316803`*^9}, {
   3.860576745144547*^9, 3.860576777229001*^9}, {3.860576847233197*^9, 
   3.860576862475911*^9}, {3.860576908123687*^9, 3.860576909525054*^9}, {
   3.860577378158867*^9, 3.860577388869587*^9}, {3.860577825732087*^9, 
   3.8605778357135487`*^9}, {3.860581936685192*^9, 3.860581946042921*^9}, {
   3.860659745713543*^9, 3.860659771497184*^9}, {3.8606598181942797`*^9, 
   3.86065984987954*^9}, {3.8606599056459103`*^9, 3.8606600071366997`*^9}, {
   3.860660052807386*^9, 3.860660083600241*^9}, {3.860660123061139*^9, 
   3.860660124449803*^9}, {3.8606601880136223`*^9, 3.860660216448731*^9}, 
   3.860660298258813*^9, {3.8623931039302397`*^9, 3.862393104472218*^9}, {
   3.928051085367333*^9, 3.928051087108313*^9}, {3.958287398535617*^9, 
   3.958287403194322*^9}, {3.959857200822785*^9, 3.9598572280621223`*^9}, {
   3.959857653399556*^9, 3.9598576750439177`*^9}, {3.9598577971022797`*^9, 
   3.959857801856675*^9}, {3.9598584883738737`*^9, 3.959858493374227*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"afaca944-bd84-41f6-bd75-5195a026a976"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Truncate", " ", "our", " ", "Gaussian", " ", "distribution"}], 
   " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vergTruncPDFms", "=", 
     FractionBox["vergFullPDF", 
      RowBox[{
       RowBox[{"vergFullCDF", "[", "maxVerg", "]"}], "-", 
       RowBox[{"vergFullCDF", "[", "minVerg", "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"vergTruncPDFms", "=", 
    RowBox[{"FullSimplify", "[", "vergTruncPDFms", "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.860660297277595*^9, 3.862393116375991*^9, 3.8623931521630793`*^9, {
   3.862393224401709*^9, 3.862393228688014*^9}, {3.92805109869984*^9, 
   3.9280510991667633`*^9}, {3.9582872883473063`*^9, 3.958287296837522*^9}, {
   3.9598577243622913`*^9, 3.959857752683717*^9}, {3.959857815391814*^9, 
   3.959857816239627*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"92f903b8-e85b-450c-b18f-114d601b79a6"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "x"}], ")"}], "2"], 
      RowBox[{"2", " ", 
       SuperscriptBox["s", "2"]}]]}]], " ", 
   SqrtBox[
    FractionBox["2", "\[Pi]"]]}], 
  RowBox[{"s", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Erf", "[", 
      FractionBox["m", 
       RowBox[{
        SqrtBox["2"], " ", "s"}]], "]"}], "+", 
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "m"}], "+", "\[Pi]"}], 
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", "s"}]], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.9598577733007107`*^9, 3.959857817277066*^9, 3.959857928790882*^9, 
   3.959858015131562*^9, 3.9598580636363163`*^9, 3.959858146740409*^9, 
   3.959858191305036*^9, {3.9598582397241287`*^9, 3.959858268203012*^9}, 
   3.959858321602968*^9, 3.959858406571031*^9, 3.9598585302331457`*^9, 
   3.959858649135556*^9, 3.959859836172667*^9, 3.960271920719822*^9},
 CellLabel->
  "Out[339]=",ExpressionUUID->"fc59e6a8-064a-4596-9214-ad4d1633e325"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "two", " ", "ways", " ", "to", " ", "make", " ", "the", " ", 
    "truncated", " ", "distribution", " ", "are", " ", "mathematically", " ", 
    "identical"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"truncVergPDF", "[", "x", "]"}], "==", "vergTruncPDFms"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9598578208576593`*^9, 3.959857869042706*^9}, {
   3.959858309862734*^9, 3.959858371118802*^9}, 3.9598584134768143`*^9, {
   3.9598585943363733`*^9, 3.959858616022463*^9}},
 CellLabel->
  "In[340]:=",ExpressionUUID->"fcf70bcd-2e9e-4734-a450-14701968a071"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.9598578265217657`*^9, {3.959858317614395*^9, 3.959858371511877*^9}, {
   3.959858407269939*^9, 3.959858413959474*^9}, 3.95985853024571*^9, 
   3.959858649149053*^9, 3.959859836184308*^9, 3.9602719207345343`*^9},
 CellLabel->
  "Out[340]=",ExpressionUUID->"1d12af65-eb50-434b-b5d3-ed7ce48d7475"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "domain", " ", "of", " ", "the", " ", "truncated", " ", 
    "vergence", " ", "PDF", " ", "and", " ", "assuptions", " ", "for", " ", 
    "Mathstatica"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"domain", "[", "vergTruncPDFms", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "minVerg", ",", "maxVerg"}], "}"}], "&&", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "\[Element]", "Reals"}], ",", 
       RowBox[{"h", ">", "0"}], ",", 
       RowBox[{"s", ">", "0"}]}], "}"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.959858511328665*^9, {3.959858581561302*^9, 3.959858582972887*^9}},
 CellLabel->
  "In[341]:=",ExpressionUUID->"3ca08cde-d19b-4bc6-a400-c4859bcd960a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Change", " ", "of", " ", "Variables", " ", "via", " ", "Mathstatica"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"distPDF", "=", 
     RowBox[{"Transform", "[", 
      RowBox[{
       RowBox[{"y", "\[Equal]", 
        RowBox[{"h", "/", 
         RowBox[{"Tan", "[", "x", "]"}]}]}], ",", " ", "vergTruncPDFms"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"distPDF", "=", 
    RowBox[{"FullSimplify", "[", "distPDF", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.958287038629912*^9, 3.958287077134511*^9}, {
   3.958287129612925*^9, 3.958287131171331*^9}, {3.958287314356512*^9, 
   3.9582873163076878`*^9}, {3.958287831330283*^9, 3.9582878449523993`*^9}, {
   3.9582885840856733`*^9, 3.958288584493678*^9}, {3.9582886276215*^9, 
   3.958288629991461*^9}, {3.959857873762253*^9, 3.959857891845748*^9}, 
   3.959858444972631*^9},
 CellLabel->
  "In[342]:=",ExpressionUUID->"c4fdd50f-3115-47b2-8d17-ce788345c51a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", 
         RowBox[{"ArcCot", "[", 
          FractionBox["y", "h"], "]"}]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       SuperscriptBox["s", "2"]}]]}]], " ", "h", " ", 
   SqrtBox[
    FractionBox["2", "\[Pi]"]]}], 
  RowBox[{"s", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["h", "2"], "+", 
     SuperscriptBox["y", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Erf", "[", 
      FractionBox["m", 
       RowBox[{
        SqrtBox["2"], " ", "s"}]], "]"}], "+", 
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "m"}], "+", "\[Pi]"}], 
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", "s"}]], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.9598585148117247`*^9, 3.959858530303545*^9}, 
   3.959858649353869*^9, 3.9598598362394867`*^9, 3.96027192090401*^9},
 CellLabel->
  "Out[343]=",ExpressionUUID->"64cb4981-3acf-4028-85ee-2de4fd4b6b87"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "two", " ", "ways", " ", "to", " ", "make", " ", "the", " ", 
    "transformed", " ", "distribution", " ", "are", " ", "mathematically", " ",
     "identical"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"fY", "[", "y", "]"}], "==", "distPDF"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.959858634223508*^9, 3.9598586682801237`*^9}},
 CellLabel->
  "In[344]:=",ExpressionUUID->"cc978a72-9c3d-4b81-a46f-171a5c42a60d"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.959858649760935*^9, 3.959859836285028*^9, 
  3.960271921426157*^9},
 CellLabel->
  "Out[344]=",ExpressionUUID->"33240f72-8995-4129-9825-358a50478eef"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1311, 990},
WindowMargins->{{73, Automatic}, {Automatic, -61}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
SpellingDictionaries->{"CorrectWords"->{
 "vergence", "Mathstatica", "Vergence"}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4626acb4-0213-4ae6-9cab-fe1ac68119ad"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 156, 3, 29, "Input",ExpressionUUID->"b629bd2a-9a2b-4c51-862d-3ff989be6f89"],
Cell[CellGroupData[{
Cell[581, 20, 264, 6, 96, "Title",ExpressionUUID->"46c6cc27-553e-4012-9717-2846414b1aca"],
Cell[848, 28, 324, 5, 52, "Subtitle",ExpressionUUID->"0880dd66-3db0-416f-8f85-e37832f61631"],
Cell[CellGroupData[{
Cell[1197, 37, 197, 3, 67, "Chapter",ExpressionUUID->"72e5adbe-0e88-4754-a491-614a63a93c40"],
Cell[1397, 42, 485, 9, 114, "Subtitle",ExpressionUUID->"fb494ea7-5bf3-4ae6-8a59-7c78d43b68b1"],
Cell[CellGroupData[{
Cell[1907, 55, 196, 3, 66, "Section",ExpressionUUID->"08877bc0-957c-4be6-9879-0691d5e3c32c"],
Cell[2106, 60, 520, 14, 70, "Input",ExpressionUUID->"44a5c625-b3b3-47e7-8aa4-4d4f3e649e53"],
Cell[CellGroupData[{
Cell[2651, 78, 645, 17, 70, "Input",ExpressionUUID->"a858088c-b2b6-4b66-89c7-d73c92073930"],
Cell[3299, 97, 893, 22, 67, "Output",ExpressionUUID->"3884bdd3-8cf2-4ab2-b98c-6b3721fde5be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4229, 124, 1270, 33, 70, "Input",ExpressionUUID->"c044cf71-b31c-4968-8c1c-9594573ea96a"],
Cell[5502, 159, 1186, 34, 87, "Output",ExpressionUUID->"34d935d9-d110-4f53-a3ce-4eb4ef0edbac"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6737, 199, 277, 4, 66, "Section",ExpressionUUID->"183a856a-1b25-42f8-b249-5a659f85f2f7"],
Cell[CellGroupData[{
Cell[7039, 207, 229, 5, 53, "Subsection",ExpressionUUID->"6396a341-630f-4596-b0c5-2901d16ba3fa"],
Cell[CellGroupData[{
Cell[7293, 216, 719, 15, 49, "Input",ExpressionUUID->"b164ce35-77bb-4b0c-9c2f-da0d0d11d1d9"],
Cell[8015, 233, 1670, 26, 49, "Output",ExpressionUUID->"61d7b7eb-8952-4a7e-8a7e-1582e18d1c33"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9722, 264, 966, 21, 70, "Input",ExpressionUUID->"6969af7a-a7e0-4ee1-9646-5ed7be0fdcf7"],
Cell[10691, 287, 2281, 37, 50, "Output",ExpressionUUID->"81c78a6b-fe14-4940-9bb8-6784027ca348"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13009, 329, 973, 23, 70, "Input",ExpressionUUID->"01333b3b-be55-4209-8ca2-d81a0c8ee3d0"],
Cell[13985, 354, 1959, 31, 50, "Output",ExpressionUUID->"e8dce85a-7d25-4b7a-84ce-7ea30fdf2c7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15981, 390, 1055, 21, 70, "Input",ExpressionUUID->"687bf7dc-1a75-48f0-a532-4bedd33f47d7"],
Cell[17039, 413, 2814, 61, 95, "Output",ExpressionUUID->"a88d6d9a-85a8-4700-b240-be5933a3efe9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19914, 481, 176, 3, 66, "Section",ExpressionUUID->"7b5c497d-cf5a-48c6-a7a2-527e458c5ca2"],
Cell[CellGroupData[{
Cell[20115, 488, 268, 6, 53, "Subsection",ExpressionUUID->"cf43a9f6-0c49-4492-bc9c-c6e34737d059"],
Cell[20386, 496, 3112, 48, 49, "Input",ExpressionUUID->"afaca944-bd84-41f6-bd75-5195a026a976"],
Cell[CellGroupData[{
Cell[23523, 548, 955, 21, 91, "Input",ExpressionUUID->"92f903b8-e85b-450c-b18f-114d601b79a6"],
Cell[24481, 571, 1173, 34, 81, "Output",ExpressionUUID->"fc59e6a8-064a-4596-9214-ad4d1633e325"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25691, 610, 689, 15, 49, "Input",ExpressionUUID->"fcf70bcd-2e9e-4734-a450-14701968a071"],
Cell[26383, 627, 350, 6, 33, "Output",ExpressionUUID->"1d12af65-eb50-434b-b5d3-ed7ce48d7475"]
}, Open  ]],
Cell[26748, 636, 805, 21, 49, "Input",ExpressionUUID->"3ca08cde-d19b-4bc6-a400-c4859bcd960a"],
Cell[CellGroupData[{
Cell[27578, 661, 1021, 24, 70, "Input",ExpressionUUID->"c4fdd50f-3115-47b2-8d17-ce788345c51a"],
Cell[28602, 687, 1125, 36, 86, "Output",ExpressionUUID->"64cb4981-3acf-4028-85ee-2de4fd4b6b87"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29764, 728, 544, 12, 49, "Input",ExpressionUUID->"cc978a72-9c3d-4b81-a46f-171a5c42a60d"],
Cell[30311, 742, 203, 4, 33, "Output",ExpressionUUID->"33240f72-8995-4129-9825-358a50478eef"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

